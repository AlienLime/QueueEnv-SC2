
2023-06-08 09:37:36,051	INFO worker.py:1625 -- Started a local Ray instance.
[36m(RolloutWorker pid=72672)[39m !RESETTING ENVIRONMENT!
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:37:47,390	WARNING env.py:155 -- Your env doesn't have a .spec.max_episode_steps attribute. Your horizon will default to infinity, and your environment will not be reset.
[36m(RolloutWorker pid=72672)[39m starting game.
[36m(RolloutWorker pid=72672)[39m !RESETTING ENVIRONMENT!
[36m(RolloutWorker pid=72672)[39m starting game.
[36m(RolloutWorker pid=72672)[39m !RESETTING ENVIRONMENT!
[36m(RolloutWorker pid=72672)[39m starting game.
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:37:59.975 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.launched (was None)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:37:59.975 | INFO     | sc2.controller:create_game:37 - Creating new game
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:37:59.975 | INFO     | sc2.controller:create_game:38 - Map:     TrainingMapResource
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:37:59.975 | INFO     | sc2.controller:create_game:39 - Players: Bot ArmyBot(Terran), Computer Hard(Zerg, RandomBuild)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:37:59.977 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.init_game (was Status.launched)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:03.908 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.launched (was None)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:03.908 | INFO     | sc2.controller:create_game:37 - Creating new game
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:03.908 | INFO     | sc2.controller:create_game:38 - Map:     TrainingMapResource
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:03.909 | INFO     | sc2.controller:create_game:39 - Players: Bot ArmyBot(Terran), Computer Hard(Zerg, RandomBuild)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:03.910 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.init_game (was Status.launched)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:05.448 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.in_game (was None)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:05.448 | INFO     | sc2.main:_play_game:221 - Player 1 - Bot ArmyBot(Terran)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:08.987 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.in_game (was None)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:08.988 | INFO     | sc2.main:_play_game:221 - Player 1 - Bot ArmyBot(Terran)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:09.872 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.launched (was None)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:09.872 | INFO     | sc2.controller:create_game:37 - Creating new game
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:09.872 | INFO     | sc2.controller:create_game:38 - Map:     TrainingMapResource
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:09.872 | INFO     | sc2.controller:create_game:39 - Players: Bot ArmyBot(Terran), Computer Hard(Zerg, RandomBuild)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:09.873 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.init_game (was Status.launched)
2023-06-08 09:38:15,708	ERROR actor_manager.py:507 -- Ray error, taking actor 1 out of service. The actor died because of an error raised in its creation task, [36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
During handling of the above exception, another exception occurred:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "python\ray\_raylet.pyx", line 870, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 921, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 877, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 881, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 821, in ray._raylet.execute_task.function_executor
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\function_manager.py", line 670, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\util\tracing\tracing_helper.py", line 460, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\rollout_worker.py", line 616, in __init__
    check_env(self.env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 92, in check_env
    raise ValueError(
ValueError: Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 220, in check_gym_environments
    results = env.step(sampled_action)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
The above error has been found in your environment! We've added a module for checking your custom environments. It may cause your experiment to fail if your environment is not set up correctly. You can disable this behavior via calling `config.environment(disable_env_checking=True)`. You can run the environment checking module standalone by calling ray.rllib.utils.check_env([your env]).
Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 172, in __init__
    self._setup(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 242, in _setup
    self.add_workers(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 635, in add_workers
    raise result.get()
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\actor_manager.py", line 488, in __fetch_result
    result = ray.get(r)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\worker.py", line 2523, in get
    raise value
ray.exceptions.RayActorError: The actor died because of an error raised in its creation task, [36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
During handling of the above exception, another exception occurred:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "python\ray\_raylet.pyx", line 870, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 921, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 877, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 881, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 821, in ray._raylet.execute_task.function_executor
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\function_manager.py", line 670, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\util\tracing\tracing_helper.py", line 460, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\rollout_worker.py", line 616, in __init__
    check_env(self.env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 92, in check_env
    raise ValueError(
ValueError: Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 220, in check_gym_environments
    results = env.step(sampled_action)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
The above error has been found in your environment! We've added a module for checking your custom environments. It may cause your experiment to fail if your environment is not set up correctly. You can disable this behavior via calling `config.environment(disable_env_checking=True)`. You can run the environment checking module standalone by calling ray.rllib.utils.check_env([your env]).
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 162, in <module>
    train_ppo()
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 137, in train_ppo
    algo = config.build(env=QueueEnv)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\algorithms\algorithm_config.py", line 1071, in build
    return algo_class(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\algorithms\algorithm.py", line 466, in __init__
    super().__init__(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\tune\trainable\trainable.py", line 169, in __init__
    self.setup(copy.deepcopy(self.config))
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\algorithms\algorithm.py", line 592, in setup
    self.workers = WorkerSet(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 194, in __init__
    raise e.args[0].args[2]
ValueError: Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 220, in check_gym_environments
    results = env.step(sampled_action)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
The above error has been found in your environment! We've added a module for checking your custom environments. It may cause your experiment to fail if your environment is not set up correctly. You can disable this behavior via calling `config.environment(disable_env_checking=True)`. You can run the environment checking module standalone by calling ray.rllib.utils.check_env([your env]).
Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 172, in __init__
    self._setup(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 242, in _setup
    self.add_workers(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 635, in add_workers
    raise result.get()
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\actor_manager.py", line 488, in __fetch_result
    result = ray.get(r)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\client_mode_hook.py", line 105, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\worker.py", line 2523, in get
    raise value
ray.exceptions.RayActorError: The actor died because of an error raised in its creation task, [36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
During handling of the above exception, another exception occurred:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "python\ray\_raylet.pyx", line 870, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 921, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 877, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 881, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 821, in ray._raylet.execute_task.function_executor
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\_private\function_manager.py", line 670, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\util\tracing\tracing_helper.py", line 460, in _resume_span
    return method(self, *_args, **_kwargs)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\rollout_worker.py", line 616, in __init__
    check_env(self.env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 92, in check_env
    raise ValueError(
ValueError: Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 220, in check_gym_environments
    results = env.step(sampled_action)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
[36mray::RolloutWorker.__init__()[39m (pid=72672, ip=127.0.0.1, repr=<ray.rllib.evaluation.rollout_worker.RolloutWorker object at 0x0000024C02B46020>)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
The above error has been found in your environment! We've added a module for checking your custom environments. It may cause your experiment to fail if your environment is not set up correctly. You can disable this behavior via calling `config.environment(disable_env_checking=True)`. You can run the environment checking module standalone by calling ray.rllib.utils.check_env([your env]).
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 162, in <module>
    train_ppo()
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 137, in train_ppo
    algo = config.build(env=QueueEnv)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\algorithms\algorithm_config.py", line 1071, in build
    return algo_class(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\algorithms\algorithm.py", line 466, in __init__
    super().__init__(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\tune\trainable\trainable.py", line 169, in __init__
    self.setup(copy.deepcopy(self.config))
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\algorithms\algorithm.py", line 592, in setup
    self.workers = WorkerSet(
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\evaluation\worker_set.py", line 194, in __init__
    raise e.args[0].args[2]
ValueError: Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 220, in check_gym_environments
    results = env.step(sampled_action)
  File "c:\Users\Emil WC\Bachelor\RL-SC2-bot\QueueEnv.py", line 91, in step
    episode_reward += reward
UnboundLocalError: local variable 'episode_reward' referenced before assignment
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 81, in check_env
    check_gym_environments(env)
  File "C:\Users\Emil WC\AppData\Local\Programs\Python\Python310\lib\site-packages\ray\rllib\utils\pre_checks\env.py", line 222, in check_gym_environments
    raise ValueError(
ValueError: Your gymnasium.Env's `step()` method raised an Exception!
The above error has been found in your environment! We've added a module for checking your custom environments. It may cause your experiment to fail if your environment is not set up correctly. You can disable this behavior via calling `config.environment(disable_env_checking=True)`. You can run the environment checking module standalone by calling ray.rllib.utils.check_env([your env]).
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:15.423 | INFO     | sc2.protocol:_execute:72 - Client status changed to Status.in_game (was None)
[36m(RolloutWorker pid=72672)[39m 2023-06-08 09:38:15.423 | INFO     | sc2.main:_play_game:221 - Player 1 - Bot ArmyBot(Terran)